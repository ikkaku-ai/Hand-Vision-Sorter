# Hand Vision Sorter (AR Color Sorting Game: 身体拡張ARゲーム)　

VisionフレームワークとRealityKitを組み合わせた、Mac向けのARハンドトラッキング・カラーソーティングゲーム。

## 主な特徴
- **ハンドトラッキングUI**: `VNDetectHumanHandPoseRequest` を使用し、カメラ越しに指先でARオブジェクトを直感的に掴んで操作できる。
- **高視認性デザイン**: 物理ベースのレンダリング（PBR)による「影で色が黒ずむ問題」を解決するために、`UnlitMaterial`を採用。どんなライディング下でも、鮮明な赤・青・白・黒の判断が可能。
- **物理シミュレーション**: RealityKitのPhysicsエンジンにより、オブジェクト同士の衝突や重力をリアルに再現。
- **クリア演出**: 全10個のオブジェクトを正しく仕分けると、オレンジ色の紙吹雪（バーティクル）が舞うエフェクトを実装している。

## 使用技術
- **Swift / SwiftUI**
- **RealityKit**: ARシーンの構築と物理演算
- **Vision Framework**: 手の形状および関節位置のリアルタイム検出
- **AVFoundation**: カメラフィードの取得

## 動作環境
- OS: macOS 14.0 (Sonoma) 以上推奨
- ハードウェア: Appleシリコン（M1/M2/M3/M4チップ）搭載Mac推奨
- その他: 
  - インカメラ（FaceTimeカメラ）を使用します。
  - ハンドトラッキングの精度を高めるため、明るい室内でのプレイを推奨します。
 
## アプリの開き方
本アプリは開発途中の作品であるため、macOSのセキュリティ制限により、
初回起動時にブロックされる場合があります。その際は以下の手順で実行してください。

【手順A：右クリックでの起動】
① 「ARHandWorld.app」を右クリック（またはControlキーを押しながらクリック）します。
② メニューから「開く」を選択します。
③ 「開発元を確認できないため開けません」という警告が出ますが、
   再度「開く」をクリックしてください。

【手順B：上記で開けない場合の最終手段】
右クリックで「開く」を選択しても起動しない場合は、以下の設定を行ってください。
① 画面左上の Appleメニュー ＞「システム設定」を開きます。
②「プライバシーとセキュリティ」を選択します。
③ 右側を一番下までスクロールし、「セキュリティ」セクションを確認します。
④「"ARHandWorld.app"は開発元を確認できないため、使用がブロックされました」
   という表示の横にある「そのまま開く」ボタンをクリックしてください。
⑤ Macのパスワードを入力し、最後に確認画面で「開く」を押すと起動します。

※カメラへのアクセス許可を求められた場合は「OK」を選択してください。

## 遊び方
1. アプリを起動し、カメラを自分または手の届く範囲に向ける。
2. スペースキーを押して、ランダムな形状・色のオブジェクトを10個生成。
3. アプリアイコンと同じような手の形（「ピンチ（つまむ）」動作）をすると、ARオブジェクトを掴める。
4. オブジェクトの色に対応した色の床（ターゲットエリア）まで運び、手を離す。
5. 全て仕分けるとクリアエフェクトが発生する。

## ショートカットキー
- `Space`: ゲームリセット　/　オブジェクトの再生成
- `矢印キー`: ARワールド全体の座標調整（オブジェクトを持っていく時、カメラの視野外にターゲットエリアがあるとき視点を矢印キーで移動できる）

## 注意点
* 遊ぶ時、カメラが起動するのでレンズに支障があると遊べない
* 急にオブジェクトが飛んでいき、数が合わないバグ発生する可能性があるのでその時は、リセットし初めからゲームを始める
* 画面が鏡みたいになるので、距離感を取るのが難しい（手がカメラに近い時はAR画面上の手も大きくなり、手がカメラから離れている時はAR画面上の手も小さくなる）
